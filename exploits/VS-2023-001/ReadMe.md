**Description**

The attached codes are reduced from the original exploits by Kaspersky’s Boris Larin and Google’s Security Researcher - Maddie Stone, hence they are also in C++.

It must be built in Microsoft Visual Studio. And, as x64 release to work and not Debug, Debug builds will not connect to the LPC port.

Once, the exploit is built, the following command must be written in the cmd to set permissions –

icacls exploit.exe /setintegritylevel L

Move the CreateDC.exe into the same directory as the exploit.exe CreateDC.exe is simply an x86 application that calls CreateDCA in order to start splwow64.exe driver.

Then, in the cmd keep the CreateDC.exe and then run the exploit by clicking on the exe.

exploit.exe


**Windows Version Tested**
                
+ CVE-2021-1648
    + Windows 10 - 2004 (OS Build 19041.630)
+ CVE-2020-0986
    + Windows 10 - 1909 (OS Build 18363.418)

**References** 

https://bugs.chromium.org/p/project-zero/issues/detail?id=2096

https://googleprojectzero.github.io/0days-in-the-wild/0day-RCAs/2020/CVE-2020-0986.html

https://byteraptors.github.io/windows/exploitation/2020/05/24/sandboxescape.html


**Thanks** 

@maddiestone for the second printer bug and all the detailed explanations to replicate the bugs

@oct0xor from @kaspersky for the first printer bug

Byteraptors for explanations for a previous printer bug.
